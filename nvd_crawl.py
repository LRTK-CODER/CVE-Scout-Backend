import sys
from Crawling import NVD_CVE_Parser, Save_DB

NVD_API_URL = "https://services.nvd.nist.gov/rest/json/cves/2.0/"
nvd = NVD_CVE_Parser(NVD_API_URL)

start_index = 0
results_per_page = 2000

save_db = Save_DB(json_path="./jsons")

if len(sys.argv) > 1:
    if sys.argv[1] == "all":
        while True:
            if isinstance(nvd.fetch_cve_data(start_index, results_per_page), bool): break
            start_index += results_per_page
        save_db.save("CVE_INFO")
    elif sys.argv[1] == "update":
        update_cve_list = nvd.fetch_modified_cve_data()
        save_db.update("CVE_INFO", update_cve_list)
    else:
        print("Invalid argument. Please provide 'all' or 'update'.")
else:
    print("No argument provided. Please provide 'all' or 'update'.")